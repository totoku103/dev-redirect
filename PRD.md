# DevRedirect 제품 요구사항 문서 (PRD)

## 1. 개요

- **제품명:** DevRedirect (가칭)
- **목적:** 개발 시 애플리케이션에 하드코딩된 DB 서버 주소(IP:PORT)를 수정하지 않고도, 운영 서버 대신 개발/테스트 서버로 연결되도록 지원하는 유틸리티.
- **핵심 가치:**
  - 코드 변경/재빌드 없이 개발 환경 전환 가능
  - 맥/윈도우 크로스플랫폼 지원
  - 단순하고 직관적인 사용법

## 2. 문제 정의

- 많은 애플리케이션이 DB 주소를 하드코딩된 IP:PORT로 참조함.
- 개발 시 운영 DB를 사용하면 데이터 손상/보안 위험 존재.
- 코드 수정 없이 개발/테스트 DB로 우회하고자 할 때 시스템 차원의 네트워크 리다이렉션이 필요.

## 3. 목표

- 개발자가 운영 서버 주소를 그대로 유지한 상태에서 앱을 실행해도, 실제 연결은 개발 DB로 우회.
- 설치와 제거가 간단해야 하고, 기존 네트워크 설정에 최소한의 영향만 주어야 함.

## 4. 사용자 시나리오

1. 개발자가 운영 코드(203.0.113.5:5432)를 실행.
2. 앱은 하드코딩된 IP:PORT로 DB 연결 시도.
3. DevRedirect가 OS 네트워크 계층에서 트래픽을 가로채어 (203.0.113.5:5432 → 10.0.0.5:5432).
4. 앱은 변경 없이 개발 DB에 정상 연결됨.
5. 작업 완료 후 간단히 규칙을 제거 가능.

## 5. 요구사항

### 5.1 기능적 요구사항

- **IP/포트 리다이렉션**
  - 입력: 원본 IP:PORT
  - 출력: 대체 IP:PORT
  - TCP 필수 지원, UDP는 선택
- **플랫폼 지원**
  - macOS: ifconfig lo0 alias + pfctl 기반
  - Windows: netsh portproxy 기반
- **규칙 관리**
  - 규칙 추가, 삭제, 조회 지원
  - 복수 규칙 지원 (여러 DB/서비스 동시 전환 가능)
- **실행 권한**
  - 관리자 권한 필요 (네트워크 인터페이스 조작 때문)
- **안전성**
  - 기본적으로 로컬에서만 적용
  - 시스템 재부팅 시 자동 복원 여부 선택 가능

### 5.2 비기능적 요구사항

- **사용성:** CLI 기반, 단순 명령으로 규칙 추가/삭제 가능
- **성능:** DB 접속 시 지연시간 최소화 (직접 TCP 패킷 포워딩 수준)
- **보안:** 외부 노출 차단 (127.0.0.1 기반), 로깅 최소화

## 6. 아키텍처 개요

- **Windows:**
  - 루프백/이더넷 인터페이스에 가짜 IP 추가
  - netsh interface portproxy로 트래픽 우회
- **macOS:**
  - lo0 인터페이스에 가짜 IP alias 추가
  - pf의 rdr pass 규칙으로 우회

## 7. 명령어 예시

```
# macOS
devredirect add 203.0.113.5:5432 10.0.0.5:5432

# Windows (PowerShell)
devredirect add 203.0.113.5:5432 10.0.0.5:5432

# 규칙 조회
devredirect list

# 규칙 삭제
devredirect remove 203.0.113.5:5432
```

## 8. 성공 지표 (Success Metrics)

- 95% 이상의 개발자가 코드 수정 없이 개발 DB 접속 성공
- 설치/해제 절차 < 1분 소요
- 성능 저하 (연결 지연) 5ms 이하

## 9. 제약사항

- 관리자 권한 필요 (일반 사용자 권한으로 불가)
- UDP 지원은 1차 버전 제외 가능
- 일부 환경(사내 보안 솔루션, VPN)과 충돌 가능

## 10. 향후 확장

- GUI 제공 (개발자 편의성 강화)
- 규칙 프로파일 저장/불러오기 기능
- Linux 지원 (iptables 기반)
- UDP/TUN 기반 투명 모드 추가

